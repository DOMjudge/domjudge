#!/usr/bin/env php
<?php declare(strict_types=1);
/**
 * @configure_input@
 *
 * This script outputs configuration settings in TeX format for
 * inclusion in the team manual. When the system is still
 * unconfigured, it tries to get the configuration from a direct path
 * inclusion or reverts to defaults; this allows a team manual to be
 * included in the source distribution.
 *
 * Part of the DOMjudge Programming Contest Jury System and licensed
 * under the GNU GPL. See README and COPYING for details.
 */
if (isset($_SERVER['REMOTE_ADDR'])) {
    die("Commandline use only");
}

$config = '@domserver_etcdir@/domserver-static.php';

// This script might be run before or after autoconf variable
// substitution.
if (is_readable($config)) {
    require($config);
}

// FIXME: we need to read some of these variables from the MySQL DB.
$configvars = [
    'BASEURL'                   => 'https://example.com/domjudge/',
    'DOMJUDGE_VERSION'          => 'unknown',
    'SOURCESIZE'                => 256,
    'COMPILETIME'               => 30,
    'PROCLIMIT'                 => 15,
    'SUBMITCLIENT_ENABLED'      => 'yes',
    ];

foreach ($configvars as $var => $default) {
    $value = defined($var) ? constant($var) : $default;
    echo '\\def\\' . str_replace('_', '', $var) . '{' . $value . "}\n";
}

exit(0);

#!/usr/bin/php -q
<?php
/**
 * @configure_input@
 *
 * This script outputs configuration settings in TeX format for
 * inclusion in the team manual. When the system is still
 * unconfigured, it tries to get the configuration from a direct path
 * inclusion or reverts to defaults; this allows a team manual to be
 * included in the source distribution.
 *
 * $Id$
 *
 * Part of the DOMjudge Programming Contest Jury System and licenced
 * under the GNU GPL. See README and COPYING for details.
 */
if ( isset($_SERVER['REMOTE_ADDR']) ) die ("Commandline use only");

$config = '@domserver_etcdir@/domserver-static.php';

if ( is_readable($config) ) {
	require($config);
	require(ETCDIR . '/domserver-config.php');
	@include(ETCDIR . '/judgehost-config.php');
} else {
	@include('../../etc/domserver-config.php');
	@include('../../etc/judgehost-config.php');
	define('DOMJUDGE_VERSION', `sed -n '1s/.*version //p' ../../README | tr -d '\n'`);
}

$configvars = array(
	'DOMJUDGE_VERSION' => 'unknown',
	'SOURCESIZE'       => 256,
	'WEBBASEURI'       => 'http://domjudge.example.com/',
	'COMPILETIME'      => 30,
	'MEMLIMIT'         => 524288,
	'FILELIMIT'        => 4096,
	'PROCLIMIT'        => 10,
	'USERSUBMITDIR'    => '.domjudge'
	);

foreach ($configvars as $var => $default) {
	$value = defined($var) ? constant($var) : $default;
	echo '\\def\\' . $var . '{' . $value . "}\n";
}

exit(0);
